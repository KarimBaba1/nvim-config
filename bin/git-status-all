#!/usr/bin/env bash
# set -x

echo "Projects with changes:"
echo

if [[ ! -f ~/.open-project.cache ]]; then
  fdfind -H "^project.vim" $HOME | sed -e 's|/\.devbase.*||' -e 's|/project.vim||' -e "s|$HOME/||" > ~/.open-project.cache
fi
projs="$(cat ~/.open-project.cache)"

for base in $projs; do
  if [[ -d $base/.git ]]; then
    if git -C $HOME/$base status 2>/dev/null | grep -q "Changes\|Untracked"; then
      echo $base
    fi
  fi
done

any-key
